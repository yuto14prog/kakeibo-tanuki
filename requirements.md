# Kakeibo Tanuki - Requirements Document

## プロジェクト概要

Kakeibo Tanuki は個人・家庭向けの家計簿管理ウェブアプリケーションです。支出の記録、分類、分析を通じて家計の可視化と管理を支援します。

## 機能要件

### 1. 支払い方法管理 (Card Management)
- ✅ **1.1** 支払い方法の作成（名前、色設定）
- ✅ **1.2** 支払い方法の一覧表示
- ✅ **1.3** 支払い方法の編集・削除
- ✅ **1.4** 支払い方法の使用状況チェック（関連支出がある場合は削除防止）

### 2. カテゴリ管理 (Category Management)
- ✅ **2.1** カテゴリの作成（名前、色設定、共通フラグ）
- ✅ **2.2** カテゴリの一覧表示
- ✅ **2.3** カテゴリの編集・削除
- ✅ **2.4** 共通カテゴリの設定（共有支出用）
- ✅ **2.5** カテゴリ名の重複チェック

### 3. 支出管理 (Expense Management)
- ✅ **3.1** 支出の記録（金額、日付、説明、支払い方法、カテゴリ）
- ✅ **3.2** 支出の一覧表示（ページネーション対応）
- ✅ **3.3** 支出の編集・削除
- ✅ **3.4** 支出のフィルタリング（日付、カテゴリ、支払い方法）
- ✅ **3.5** 未来日付の支出入力防止

### 4. レポート機能 (Reports)
- ✅ **4.1** 月次レポート表示
  - ✅ カテゴリ別支出分析
  - ✅ 支払い方法別支出分析
  - ✅ 共通支出の割り勘計算
  - ✅ Chart.js による可視化
- ✅ **4.2** 年次レポート表示
  - ✅ 月別支出推移
  - ✅ カテゴリ別年間分析
- ✅ **4.3** レポートフィルタリング（月/年選択、支払い方法フィルタ）

### 5. データ検証・品質保証
- ✅ **5.1** 入力データの検証
  - ✅ 金額の正数チェック
  - ✅ 必須フィールドの検証
  - ✅ 文字数制限チェック
  - ✅ 色コード形式の検証
- ✅ **5.2** データベース制約
  - ✅ 外部キー制約
  - ✅ ユニーク制約（カテゴリ名）
  - ✅ NOT NULL 制約

## 非機能要件

### 6. パフォーマンス要件
- ✅ **6.1** APIレスポンス時間 < 500ms
- ✅ **6.2** 大量データの効率的な処理（ページネーション）
- ✅ **6.3** データベースクエリの最適化

### 7. セキュリティ要件
- ✅ **7.1** 入力値の検証・サニタイズ
- ✅ **7.2** SQLインジェクション対策（ORM使用）
- ✅ **7.3** 適切なエラーハンドリング
- ✅ **7.4** UUID使用による予測困難なID生成

### 8. 可用性・信頼性要件
- ✅ **8.1** 構造化されたエラーレスポンス
- ✅ **8.2** データの整合性保証
- ✅ **8.3** ロバストなエラーハンドリング

### 9. テスト要件
- ✅ **9.1** 包括的なテストカバレッジ
  - ✅ Unit Tests（モデル、バリデーション）
  - ✅ Integration Tests（リポジトリ、API）
  - ⏳ E2E Tests（フロントエンド）
- ✅ **9.2** 自動化されたテスト実行
- ✅ **9.3** テストデータの分離・独立性

## 技術要件

### 10. フロントエンド技術
- ✅ **10.1** React 18 + TypeScript
- ✅ **10.2** Vite (ビルドツール)
- ✅ **10.3** Tailwind CSS (スタイリング)
- ✅ **10.4** Chart.js (データ可視化)
- ✅ **10.5** レスポンシブデザイン

### 11. バックエンド技術
- ✅ **11.1** Go + Gin Framework
- ✅ **11.2** PostgreSQL (Production)
- ✅ **11.3** SQLite (Testing)
- ✅ **11.4** GORM (ORM)
- ✅ **11.5** Clean Architecture

### 12. 開発・デプロイ要件
- ✅ **12.1** Docker コンテナ化
- ✅ **12.2** 開発環境の構築
- ✅ **12.3** マイグレーション管理
- ⏳ **12.4** CI/CD パイプライン

## 品質保証

### 13. テスト実装状況
- ✅ **13.1** 合計 81 テストケース実装
  - ✅ Unit Tests: 22 cases
  - ✅ Repository Integration Tests: 7 cases
  - ✅ API Integration Tests: 52 cases
- ✅ **13.2** 全テストPASS達成
- ✅ **13.3** エラーハンドリングの完全カバレッジ

### 14. コード品質
- ✅ **14.1** Go標準に準拠したコード構造
- ✅ **14.2** TypeScript 厳密モード
- ✅ **14.3** 適切なエラーハンドリング
- ✅ **14.4** 一貫したコーディングスタイル

## 制約・前提条件

### 15. 技術制約
- ✅ **15.1** シングルユーザー対応（認証なし）
- ✅ **15.2** 日本円単一通貨対応
- ✅ **15.3** ブラウザ対応（モダンブラウザ）

### 16. データ制約
- ✅ **16.1** カテゴリ名最大50文字
- ✅ **16.2** 支払い方法名最大50文字
- ✅ **16.3** 支出金額は正数のみ
- ✅ **16.4** 支出日付は未来日付不可

## 今後の拡張予定

### 17. 機能拡張
- ⏳ **17.1** ユーザー認証・マルチユーザー対応
- ⏳ **17.2** 複数通貨対応
- ⏳ **17.3** 予算管理機能
- ⏳ **17.4** データエクスポート機能
- ⏳ **17.5** 定期支出の自動記録

### 18. 技術改善
- ⏳ **18.1** フロントエンドテスト（React Testing Library, E2E）
- ⏳ **18.2** パフォーマンス監視
- ⏳ **18.3** セキュリティ強化
- ⏳ **18.4** Production デプロイメント

## 成功指標

### 19. 開発完了指標
- ✅ **19.1** 全機能要件の実装完了
- ✅ **19.2** 全テストケースのPASS
- ✅ **19.3** エラーハンドリングの完全実装
- ✅ **19.4** ドキュメント整備完了

### 20. 品質指標
- ✅ **20.1** テストカバレッジ > 90%
- ✅ **20.2** API エラー率 0%
- ✅ **20.3** データ整合性 100%
- ✅ **20.4** パフォーマンス要件達成